<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Garba Tycoon Pro - Community Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { user-select: none; background: #0b0b0d; color: #fff; font-family: sans-serif; margin: 0; overflow: hidden; }
        .tab-content { display: none; height: 80vh; padding: 15px; overflow-y: auto; padding-bottom: 120px; }
        .active { display: block; }
        
        /* CERCLE JAUNE ET IMAGE RONDE */
        .circle-main {
            position: relative; width: 260px; height: 260px;
            margin: 10px auto; border-radius: 50%;
            border: 6px solid #f59e0b; box-shadow: 0 0 25px #f59e0b;
            overflow: hidden; display: flex; align-items: center; justify-content: center;
            background: #1c1c1e; cursor: pointer; transition: transform 0.05s;
        }
        .circle-main:active { transform: scale(0.92); }
        .garba-img { width: 100%; height: 100%; object-fit: cover; }

        /* COMBO SLOTS */
        .combo-slot { width: 60px; height: 60px; background: #1c1c1e; border: 2px dashed #444; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px; }
        .combo-found { border: 2px solid #f59e0b; background: rgba(245, 158, 11, 0.1); }

        nav { position: fixed; bottom: 0; left: 0; right: 0; background: #111; display: flex; justify-content: space-around; padding: 12px; border-top: 1px solid #333; z-index: 100; }
        .nav-btn { display: flex; flex-direction: column; align-items: center; font-size: 9px; color: #666; }
        .nav-btn.active-tab { color: #f59e0b; font-weight: bold; }
    </style>
</head>
<body>

    <div class="p-4 max-w-md mx-auto">
        <div class="flex justify-between items-center mb-4">
            <button onclick="connectWallet()" class="bg-blue-600 hover:bg-blue-500 text-white text-[10px] px-4 py-1.5 rounded-lg font-bold transition">Connect Wallet</button>
            <div class="text-right">
                <p class="text-[8px] text-gray-500 font-bold uppercase">Profit / h</p>
                <p id="profit-rate" class="text-green-500 font-bold text-xs">+0</p>
            </div>
        </div>

        <div class="text-center mb-2">
            <h1 id="balance" class="text-5xl font-black tracking-tighter">0</h1>
        </div>

        <div id="exchange" class="tab-content active">
            <div class="bg-[#1c1c1e] p-3 rounded-2xl border border-gray-800 mb-4">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-[10px] font-black text-yellow-500 uppercase tracking-widest">Daily Combo</span>
                    <span class="text-white font-bold text-[10px]">üéÅ 5,000,000</span>
                </div>
                <div class="flex justify-center gap-4" id="combo-display">
                    <div class="combo-slot">?</div><div class="combo-slot">?</div><div class="combo-slot">?</div>
                </div>
            </div>

            <div class="circle-main" onclick="handleTap(event)">
                <img src="1770136311457.png" class="garba-img" onerror="this.src='https://cdn-icons-png.flaticon.com/512/1046/1046788.png'">
            </div>

            <div class="mt-6 text-center">
                <p class="text-yellow-500 font-black text-lg">‚ö° <span id="energy-text">1000 / 1000</span></p>
                <div class="w-64 h-2.5 bg-gray-800 rounded-full mx-auto mt-2 overflow-hidden">
                    <div id="energy-fill" class="h-full bg-yellow-500" style="width: 100%"></div>
                </div>
            </div>
        </div>

        <div id="tasks" class="tab-content">
            <h2 class="text-center font-black text-yellow-500 text-sm mb-6 uppercase">Missions Communautaires</h2>
            <div class="space-y-4">
                <div class="bg-[#1c1c1e] p-4 rounded-2xl border border-gray-800 flex justify-between items-center">
                    <div class="flex items-center gap-3">
                        <span class="text-2xl">üì¢</span>
                        <div>
                            <p class="text-xs font-bold">Rejoint le Canal</p>
                            <p class="text-[10px] text-green-500">+100,000</p>
                        </div>
                    </div>
                    <button onclick="completeTask('tg', 'https://t.me/TON_CANAL')" class="bg-white text-black text-[10px] px-4 py-2 rounded-xl font-bold">GO</button>
                </div>
                <div class="bg-[#1c1c1e] p-4 rounded-2xl border border-gray-800 flex justify-between items-center">
                    <div class="flex items-center gap-3">
                        <span class="text-2xl">üü¢</span>
                        <div>
                            <p class="text-xs font-bold">Groupe WhatsApp</p>
                            <p class="text-[10px] text-green-500">+100,000</p>
                        </div>
                    </div>
                    <button onclick="completeTask('wa', 'https://wa.me/TON_GROUPE')" class="bg-white text-black text-[10px] px-4 py-2 rounded-xl font-bold">GO</button>
                </div>
            </div>
        </div>

        <div id="mine" class="tab-content">
            <div id="cards-container" class="grid grid-cols-2 gap-3"></div>
        </div>
    </div>

    <nav>
        <button onclick="showTab('exchange')" class="nav-btn active-tab" id="btn-exchange">üè†<span>Jeu</span></button>
        <button onclick="showTab('mine')" class="nav-btn" id="btn-mine">‚õèÔ∏è<span>Mine</span></button>
        <button onclick="showTab('tasks')" class="nav-btn" id="btn-tasks">üì¢<span>Missions</span></button>
    </nav>

    <script>
        const DAILY_COMBO_IDS = [2, 4, 5]; 
        let state = JSON.parse(localStorage.getItem('garba_pro_final')) || {
            bal: 0, energy: 1000, maxE: 1000, profit: 0, foundCombo: [], lastComboClaim: "", tasks: [],
            cards: [
                { id: 1, name: "Poisson Thon", price: 1000, profit: 120, img: "üêü" },
                { id: 2, name: "Huile de Palme", price: 5000, profit: 550, img: "üß¥" },
                { id: 3, name: "Gros Charbon", price: 15000, profit: 1800, img: "üî•" },
                { id: 4, name: "Piment Frais", price: 50000, profit: 6000, img: "üå∂Ô∏è" },
                { id: 5, name: "Livreur Moto", price: 150000, profit: 20000, img: "üèçÔ∏è" }
            ]
        };

        function save() { localStorage.setItem('garba_pro_final', JSON.stringify(state)); }

        function handleTap(e) {
            if (state.energy >= 1) {
                state.bal += 1; state.energy -= 1;
                // VIBRATION ICI
                if (navigator.vibrate) navigator.vibrate(50);
                updateUI(); save();
            }
        }

        function connectWallet() {
            alert("‚ö†Ô∏è Connection Wallet : Cette fonctionnalit√© n√©cessite un serveur s√©curis√© (backend) pour se lier √† TON. En d√©veloppement !");
        }

        function completeTask(id, url) {
            if (!state.tasks.includes(id)) {
                window.open(url, '_blank');
                state.bal += 100000;
                state.tasks.push(id);
                updateUI(); save();
                alert("Bonus de 100,000 points ajout√© !");
            } else {
                window.open(url, '_blank');
            }
        }

        function buyCard(id) {
            const c = state.cards.find(x => x.id === id);
            if(state.bal >= c.price) {
                state.bal -= c.price;
                state.profit += c.profit;
                c.price = Math.floor(c.price * 1.6);
                if(DAILY_COMBO_IDS.includes(id) && !state.foundCombo.includes(id)) {
                    state.foundCombo.push(id);
                    if(state.foundCombo.length === 3) {
                        state.bal += 5000000;
                        alert("COMBO R√âSOLU ! +5,000,000");
                    }
                }
                updateUI(); renderCards(); save();
            }
        }

        function renderCards() {
            const container = document.getElementById('cards-container');
            container.innerHTML = state.cards.map(c => `
                <div onclick="buyCard(${c.id})" class="bg-[#1c1c1e] p-4 rounded-2xl border border-gray-800 text-center">
                    <span class="text-3xl">${c.img}</span>
                    <p class="text-[10px] font-black mt-2 uppercase">${c.name}</p>
                    <p class="text-[9px] text-green-500 font-bold">+${c.profit}/h</p>
                    <button class="w-full bg-yellow-600 text-black text-[10px] py-2 mt-3 rounded-xl font-black">${c.price.toLocaleString()}</button>
                </div>
            `).join('');
        }

        function showTab(id) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active-tab'));
            document.getElementById('btn-'+id).classList.add('active-tab');
            if(id === 'mine') renderCards();
        }

        function updateUI() {
            document.getElementById('balance').innerText = Math.floor(state.bal).toLocaleString();
            document.getElementById('profit-rate').innerText = "+" + state.profit.toLocaleString();
            document.getElementById('energy-text').innerText = Math.floor(state.energy) + " / " + state.maxE;
            document.getElementById('energy-fill').style.width = (state.energy / 10) + "%";
            document.getElementById('combo-display').innerHTML = [0,1,2].map(i => {
                const cardId = state.foundCombo[i];
                return cardId ? `<div class="combo-slot combo-found">${state.cards.find(x => x.id === cardId).img}</div>` : `<div class="combo-slot">?</div>`;
            }).join('');
        }

        setInterval(() => {
            state.bal += (state.profit / 3600);
            if (state.energy < state.maxE) state.energy = Math.min(state.maxE, state.energy + 2);
            updateUI();
        }, 1000);

        updateUI();
    </script>
</body>
</html>
