<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Garba Tycoon Pro Cloud</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "TA_CLE_FIREBASE",
            authDomain: "ton-projet.firebaseapp.com",
            projectId: "ton-projet",
            appId: "1:12345:web:6789"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        let userId = "user_telegram_001"; 
        let userRef = doc(db, "players", userId);

        window.state = { bal: 0, energy: 1000, maxE: 1000, profit: 0, lastAd: 0 };

        async function loadData() {
            const docSnap = await getDoc(userRef);
            if (docSnap.exists()) window.state = docSnap.data();
            updateUI();
        }
        loadData();

        // Sauvegarde auto
        setInterval(() => setDoc(userRef, window.state), 5000);

        window.handleTap = (e) => {
            if (window.state.energy >= 1) {
                window.state.bal += 1;
                window.state.energy -= 1;
                if (navigator.vibrate) navigator.vibrate(40);
                updateUI();
            }
        };

        window.watchAd = () => {
            const now = Date.now();
            const waitTime = 5 * 60 * 1000; // 5 minutes

            if (now - window.state.lastAd < waitTime) {
                const reste = Math.ceil((waitTime - (now - window.state.lastAd)) / 60000);
                alert(`Patiente encore ${reste} min avant la prochaine pub !`);
                return;
            }

            window.open("https://otieu.com/4/10555812", "_blank");
            window.state.bal += 5000;
            window.state.lastAd = now;
            updateUI();
            alert("5,000 points ajout√©s ! Merci d'avoir soutenu le Garba !");
        };

        function updateUI() {
            document.getElementById('balance').innerText = Math.floor(window.state.bal).toLocaleString();
            document.getElementById('energy-text').innerText = Math.floor(window.state.energy) + " / 1000";
            document.getElementById('energy-fill').style.width = (window.state.energy / 10) + "%";
        }
    </script>

    <style>
        body { background: #0b0b0d; color: white; font-family: sans-serif; overflow: hidden; margin: 0; }
        .tab-content { display: none; height: 82vh; padding: 20px; overflow-y: auto; }
        .active { display: block; }
        .circle-main {
            width: 260px; height: 260px; margin: 20px auto;
            border-radius: 50%; border: 6px solid #f59e0b;
            box-shadow: 0 0 25px #f59e0b; overflow: hidden;
            display: flex; align-items: center; justify-content: center;
            background: #1c1c1e; transition: transform 0.05s;
        }
        .circle-main:active { transform: scale(0.92); }
        .garba-img { width: 100%; height: 100%; object-fit: cover; }
        nav { position: fixed; bottom: 0; left: 0; right: 0; background: #111; display: flex; justify-content: space-around; padding: 15px; border-top: 1px solid #333; }
        .nav-btn { display: flex; flex-direction: column; align-items: center; font-size: 10px; color: #666; }
        .nav-btn.active-tab { color: #f59e0b; }
    </style>
</head>
<body>

    <div class="p-4 max-w-md mx-auto">
        <div class="flex justify-between items-center bg-[#1c1c1e] p-3 rounded-xl border border-gray-800">
            <span class="text-xs font-bold text-blue-400">‚òÅÔ∏è Cloud Sync</span>
            <span class="text-green-500 font-bold" id="profit-rate">+0/h</span>
        </div>

        <h1 id="balance" class="text-5xl font-black text-center mt-6">0</h1>

        <div id="exchange" class="tab-content active text-center">
            <div class="circle-main" onclick="handleTap(event)">
                <img src="1770136311457.png" class="garba-img" onerror="this.src='https://cdn-icons-png.flaticon.com/512/1046/1046788.png'">
            </div>
            
            <div class="mt-4">
                <p class="text-yellow-500 font-bold text-lg">‚ö° <span id="energy-text">1000 / 1000</span></p>
                <div class="w-64 h-2.5 bg-gray-800 rounded-full mx-auto mt-2 overflow-hidden">
                    <div id="energy-fill" class="h-full bg-yellow-500" style="width: 100%"></div>
                </div>
            </div>
        </div>

        <div id="boost" class="tab-content text-center">
            <h2 class="text-xl font-black mb-8">BOOSTER DE POINTS</h2>
            <div class="bg-[#1c1c1e] p-6 rounded-3xl border border-yellow-600/30 shadow-xl">
                <span class="text-5xl">üéÅ</span>
                <h3 class="text-lg font-bold mt-4">Regarder une Vid√©o</h3>
                <p class="text-gray-400 text-xs mt-2 mb-6">Gagne 5,000 points instantan√©ment.</p>
                <button onclick="watchAd()" class="w-full bg-yellow-600 text-black font-black py-4 rounded-2xl active:scale-95 transition">
                    VOIR LA PUB (+5000)
                </button>
            </div>
        </div>

    </div>

    <nav>
        <button onclick="showTab('exchange')" class="nav-btn active-tab" id="btn-exchange">üè†<span>Jeu</span></button>
        <button onclick="showTab('boost')" class="nav-btn" id="btn-boost">üöÄ<span>Boost</span></button>
    </nav>

    <script>
        function showTab(id) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active-tab'));
            document.getElementById('btn-'+id).classList.add('active-tab');
        }

        // Profit passif chaque seconde
        setInterval(() => {
            if(window.state) {
                window.state.bal += (window.state.profit / 3600);
                if(window.state.energy < 1000) window.state.energy += 1;
                document.getElementById('balance').innerText = Math.floor(window.state.bal).toLocaleString();
                document.getElementById('energy-text').innerText = Math.floor(window.state.energy) + " / 1000";
                document.getElementById('energy-fill').style.width = (window.state.energy / 10) + "%";
            }
        }, 1000);
    </script>
</body>
</html>
